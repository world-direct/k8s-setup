###########################################
## Firewall

- name: Enable and start firewall service
  service:
    name: firewalld
    enabled: yes
    state: started

- name: Read firewall-rules-clp.yml
  include_vars:
    file: "firewall-rules-clp.yml"
    name: rulesfile

- name: Apply firewall-rules-clp.yml
  firewalld:
    port: "{{ item }}"
    permanent: yes
    state: enabled
    immediate: yes
  with_items: "{{rulesfile.rules}}"

- name: Apply custom firewall rules
  firewalld:
    port: "{{ item }}"
    permanent: yes
    state: enabled
    immediate: yes
  with_items: "{{lnxclp_custom_firewall_rules}}"

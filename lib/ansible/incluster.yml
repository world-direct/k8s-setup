- hosts: localhost
  tasks:

    - name: "run 'use-context' for verification"
      shell: "{{playbook_dir}}/../../.local/scripts/use-context"

    - name: "k8s: kube-flannel namespace"
      wd_k8snamespace:
        namespace: kube-flannel

    - name: "k8s: chart wd-flannel"
      wd_helm3:
        chart: charts/wd-flannel
        namespace: kube-flannel

    - name: "k8s: kube-metallb namespace"
      wd_k8snamespace:
        namespace: kube-metallb

    - name: "k8s: chart wd-metallb"
      wd_helm3:
        chart: charts/wd-metallb
        namespace: kube-metallb
        values:
          ip_range_start: "{{k8s_metallb_ip_start}}"
          ip_range_end: "{{k8s_metallb_ip_end}}"

    - name: "k8s: kube-dashboard namespace"
      wd_k8snamespace:
        namespace: kube-dashboard

    - name: "k8s: wd-k8sdashboard"
      wd_helm3:
        chart: charts/wd-k8sdashboard
        namespace: kube-dashboard

    - name: "k8s: kube-haproxy-ingress namespace"
      wd_k8snamespace:
        namespace: kube-haproxy-ingress

    - name: "k8s: wd-haproxy-ingress"
      wd_helm3:
        chart: charts/wd-haproxy-ingress
        namespace: kube-haproxy-ingress



